# Создание датасета

Для создания будет использован план ниже для генерации датасета.

Для тренеровки модели: [инструкция](./MODELTUNING.md)

## План создания

1. Открываем любую нейросеть
**Note:**
Рекомендуется использовать [Qwen](https://chat.qwen.ai/)
Версия Qwen3-Max
Использовать `Thinking`, если модель поддерживает этот функционал

2. Создаем 2 чата:
- Генерация ситуаций — [промпт](./prompts/txt/generate_conflict.txt)
- Преобразование в record — [промпт](./prompts/txt/to_record.txt)

**Note:**
record — единичная запись в датасете

3. Создаем файл `conflict_situations_(время создания).json`

**Note:**
Корневой элемент — массив

Пример:
```json
[ <- Массив
    {
        ...
    },
    {
        ...
    }
] <- Массив
```

4. Вставляем запись в этот массив

# Параметры записи

1. JSON формат
2. Структура одной записи JSON прописана в [этом файле](./.templates/record.json)

[Пример](./.example/record_example.json) заполненной записи

# Добавление записей

Каждая часть датасета должна храниться в отдельном файле формата `json`.

В одном файле содержится примерно 25 записей.

Рекомендуемое название файла: `conflict_situations_(время создания).json`

**Note:**
- Каждая запись должна быть проверена вручную. Все очевидные ошибки/несоответствия должны быть исправлены
- Поле `instruction` во всех случаях должно быть пустым, так как инструкция слишком длинная. Нет смысла добавлять её в отдельные части записей

# Создание датасета

Полный готовый датасет создаётся путём объединения всех частей в один файл.

Необходимый код для объединения датасета находится в [src](./src/).

Необходимо создать [.env](./.templates/.env.template) файл для корректной работы основного кода.
В нём указаны переменные для обозначения всех параметров, используемых в коде.
Например: папка с исходными данными, выходной файл, инструкция и т.п.

Команды для создания датасета:

1. Переходим в папку `src`
```bash
cd src
```

2. Запускаем [main](./src/main.py) файл через Python
```bash
python3 main.py
```

**Note:**
Пути в файле `.env` должны быть относительны файла `main.py`

# Дополнительно

## [to_txt](./src/to_txt.py)

Конвертирует файлы из [папки с md файлами](./prompts/md/) в файлы с расширением `txt` в [папку с txt файлами](./prompts/txt/)

## Создание контекста

[Prompt](./prompts/md/generate_context.md)

Создаёт 10 разных контекстов для генерации ситуаций

# Auto generator

Автоматически создает ситуации через Hugging face endpoints

1. Переходим в папку `src`
```bash
cd src
```

2. Запускаем [main](./auto_generator/main.py) файл через Python
```bash
python3 main.py
```

3. На выходе получается 2 типа файла:

conflict_situations_XX_XX_XX_XX.json - готовый оформленная часть датасета
plaint_records_XX_XX_XX_XX.json - записи, которые не смогли быть преобразованы под [формат](./.templates/record.json)

